{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/misbah_ahmed/projects/hackathon%202%20phase%202/frontend/proxy.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\n\n// API Routes that need to be proxied to the backend\nconst API_PROXY_PATHS = ['/api', '/auth'];\n\nexport function middleware(request: NextRequest) {\n  const currentPath = request.nextUrl.pathname;\n  \n  // Check if the request is for an API route that needs to be proxied\n  const isApiRoute = API_PROXY_PATHS.some(path => \n    currentPath.startsWith(path)\n  );\n\n  if (isApiRoute) {\n    // Construct the backend URL\n    const backendUrl = process.env.BACKEND_API_URL || 'http://localhost:8000';\n    const url = new URL(request.url);\n    \n    // Replace the origin with the backend URL\n    url.protocol = new URL(backendUrl).protocol;\n    url.host = new URL(backendUrl).host;\n    \n    // Fetch from the backend\n    return NextResponse.rewrite(url);\n  }\n\n  // Handle authentication middleware\n  // Get the token from cookies\n  const token = request.cookies.get('access_token')?.value || '';\n\n  // Define protected routes\n  const protectedPaths = ['/dashboard'];\n  const authPaths = ['/signin', '/signup'];\n\n  // Check if the current path is protected\n  const isProtectedPath = protectedPaths.some(path =>\n    currentPath.startsWith(path)\n  );\n\n  // If accessing a protected route without a token, redirect to sign in\n  if (isProtectedPath && !token) {\n    return NextResponse.redirect(new URL('/signin', request.url));\n  }\n\n  // If user has a token and is on auth pages, redirect to dashboard\n  const isAuthPath = authPaths.some(path =>\n    currentPath.startsWith(path)\n  );\n\n  if (token && isAuthPath) {\n    return NextResponse.redirect(new URL('/dashboard', request.url));\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */\n    {\n      source: '/((?!api|_next/static|_next/image|favicon.ico).*)',\n      missing: [\n        { type: 'header', key: 'next-router-data' },\n        { type: 'header', key: 'next-action' },\n      ],\n    },\n    // Also match API routes for proxying\n    {\n      source: '/api/:path*',\n    },\n    {\n      source: '/auth/:path*',\n    },\n  ],\n};"],"names":[],"mappings":";;;;;;AAAA;;AAEA,oDAAoD;AACpD,MAAM,kBAAkB;IAAC;IAAQ;CAAQ;AAElC,SAAS,WAAW,OAAoB;IAC7C,MAAM,cAAc,QAAQ,OAAO,CAAC,QAAQ;IAE5C,oEAAoE;IACpE,MAAM,aAAa,gBAAgB,IAAI,CAAC,CAAA,OACtC,YAAY,UAAU,CAAC;IAGzB,IAAI,YAAY;QACd,4BAA4B;QAC5B,MAAM,aAAa,6DAA+B;QAClD,MAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;QAE/B,0CAA0C;QAC1C,IAAI,QAAQ,GAAG,IAAI,IAAI,YAAY,QAAQ;QAC3C,IAAI,IAAI,GAAG,IAAI,IAAI,YAAY,IAAI;QAEnC,yBAAyB;QACzB,OAAO,8IAAY,CAAC,OAAO,CAAC;IAC9B;IAEA,mCAAmC;IACnC,6BAA6B;IAC7B,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,iBAAiB,SAAS;IAE5D,0BAA0B;IAC1B,MAAM,iBAAiB;QAAC;KAAa;IACrC,MAAM,YAAY;QAAC;QAAW;KAAU;IAExC,yCAAyC;IACzC,MAAM,kBAAkB,eAAe,IAAI,CAAC,CAAA,OAC1C,YAAY,UAAU,CAAC;IAGzB,sEAAsE;IACtE,IAAI,mBAAmB,CAAC,OAAO;QAC7B,OAAO,8IAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,WAAW,QAAQ,GAAG;IAC7D;IAEA,kEAAkE;IAClE,MAAM,aAAa,UAAU,IAAI,CAAC,CAAA,OAChC,YAAY,UAAU,CAAC;IAGzB,IAAI,SAAS,YAAY;QACvB,OAAO,8IAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;IAChE;IAEA,OAAO,8IAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;;;;;;KAMC,GACD;YACE,QAAQ;YACR,SAAS;gBACP;oBAAE,MAAM;oBAAU,KAAK;gBAAmB;gBAC1C;oBAAE,MAAM;oBAAU,KAAK;gBAAc;aACtC;QACH;QACA,qCAAqC;QACrC;YACE,QAAQ;QACV;QACA;YACE,QAAQ;QACV;KACD;AACH","debugId":null}}]
}